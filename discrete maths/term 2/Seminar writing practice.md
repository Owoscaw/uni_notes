We saw in seminar worksheet 2 that the number of labelled trees with $n$ vertices is given by Cayley's formula:$$\Huge \text{There are }n^{n-2}\text{ distinct labelled trees with }n\text{ vertices}$$However the reasoning given was not particularly rigorous, so we attempt to prove this using linear algebra. Kirchoff proved the Matrix Tree Theorem, which determines the number of spanning trees of a graph. From the worksheet, for simple graphs this states: Given a simple labelled graph $G=(V,E)$ with vertices $V=\{v_1,\dots,v_n\}$, define the matrix $M=(m)_{ij}$:$$\Huge (m)_{ij}=\begin{cases}-1&\text{if }v_iv_j\in E\\0&\text{if }v_iv_j\notin E\\d_G(v_i)&\text{if }i=j\end{cases}$$Then the number of spanning trees of $G$ is any unsigned cofactor of $M$. We want to find the number of spanning trees with $n$ vertices, so applying this result to the complete graph $K_n$ will prove our result. So we construct $M$. Note that the degree of any vertex is $n-1$, and $v_iv_j$ is always an edge:$$\Huge M=\begin{pmatrix}n-1&-1&\dots&-1\\-1&n-1&\dots&-1\\\vdots&\vdots&\ddots&\vdots\\-1&-1&\dots&n-1\end{pmatrix}$$Notice that for an undirected graph, this matrix is always symmetric. We will find the cofactor at $M_{11}$ for convenience, making the cofactor:$$\Huge C_{11}(M)=\det(M_{(1,1)})$$Where $M_{(1,1)}$ is the matrix obtained by deleting the first row and column of $M$. This will be an $(n-1)\times(n-1)$ matrix, denoted as $M_1$. So the answer to our question is given by $\det(M_1)$. Note that the elementary row operation $A_{rs}(\mu)$ does not change the determinant of a matrix, where $A_{rs}(\mu)$ represents multiplying row $r$ by $\mu$ and adding it to row $s$. This is because the determinant of the elementary matrix that represents this operation is zero. Therefore we are free to manipulate $M_1$ in this way without changing its determinant:![[changing the matrix]]Denote this new matrix as $M_1'$. We have that $\det(M_1)=\det(M_1')$, so expand $M_1'$ along the first row to get:$$\Huge \det(M_1)=\sum_{j=1}^{n-1}(M_1')_{1j}(-1)^{1+j}\det((M_1')_{(1,j)})$$Now notice every element on the top row of $M_1'$ except the first is $-1$, so the sum can be simplified:$$\Huge \det(M_1)=(n-1)\det((M_1')_{(1,1)})+\sum_{j=2}^{n-1}(-1)(-1)^{1+j}\det((M_1')_{(1,j)})$$Observe that the lower right inner matrix of $M_1'$, namely $(M_1')_{(1,1)}$ is just the $n-2$ dimensional identity matrix multiplied by $n$, so we write:$$\Huge \det(M_1)=(n-1)\det(nI_{n-2})+\sum_{j=2}^{n-1}(-1)^j\det((M_1')_{(1,j)})$$Now, similar to the above process we observe that applying the elementary row operation $P_{rs}$, swapping rows $r$ and $s$, changes the determinant by a factor of $-1$ since the determinant of the elementary matrix representing this operation has determinant $-1$. We then use this fact to make all of the $\det((M_1')_{(1,j)})$ in the same form:![[Seminar writing practice .excalidraw]]As you can see, it takes $j-2$ applications of $P_{rs}$ to make the matrix $(M_1')_{(1,j)}$ into the form on the right hand side, which I will denote as $M_1''$. So our determinant becomes:$$\Huge \det(M_1)=(n-1)\det(nI_{n-2})+\sum_{j=2}^{n-1}(-1)^j((-1)^{j-2}\det(M_1''))$$Here, we put $(-1)^{j-2}$ since each application of $P_{rs}$ changes the determinant of $(M_1')_{(1,j)}$ by a factor of $-1$. This simplifies to:$$ \det(M_1)=(n-1)\det(nI_{n-2})+\sum_{j=2}^{n-1}(-1)^{2(j-1)}\det(M_1'')=(n-1)\det(nI_{n-2})+\sum_{j=2}^{n-1}\det(M_1'')$$Since the $(-1)^{2(j-1)}$ term simplifies to $1$. Notice that the summand is no longer dependent on $j$, so this can further be simplified to:$$\Huge \det(M_1)=(n-1)\det(nI_{n-2})+(n-2)\det(M_1'')$$Now expanding $M_1''$ along the top row is very easy since every term except from the first is $0$, making the determinant:$$\Huge \det(M_1'')=-n\det((M_1'')_{(1,1)})=-n\det(nI_{n-3})$$So our overall solution becomes:$$\Huge \det(M_1)=(n-1)\det(nI_{n-2})+(n-2)(-n\det(nI_{n-3}))$$Now since both $I_{n-2}$ and $I_{n-3}$ are diagonal, their determinants are simply equal to the product of their diagonals:$$\Huge \det(nI_{n-2})=\prod_{i=1}^{n-2}n=n^{n-2},\,\,\det(nI_{n-3})=n^{n-3}$$So finally we get:$$\Huge \det(M_1)=(n-1)n^{n-2}-n(n-2)n^{n-3}=(n-1)n^{n-2}+(2n-n^2)n^{n-3}$$$$\Huge \det(M_1)=n^{n-1}-n^{n-2}+2n^{n-2}-n^{n-1}=n^{n-2}$$So we have proven the result as required, using Kirchoff's Matrix Tree theorem, that indeed there are $n^{n-2}$ distinct labelled trees with $n$ vertices.

![[plagarism declarastion.png]]