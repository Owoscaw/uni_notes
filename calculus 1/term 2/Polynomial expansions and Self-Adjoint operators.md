
We saw [[Linear Differential Equations#Differential Operators|earlier]] that it is possible to expand a piecewise smooth function in terms of basis polynomials, namely the [[Linear Differential Equations#Legendre's equation|Legendre Polynomials]]:$$\Huge f(x)=\sum_{i=0}^\infty b_iP_i(x)$$Where $\mathcal{L}_LP_i(x)=i(i+1)P_i(x)$. Legendre polynomials can be given explicitly by:$$\Huge P_i(x)=\frac{1}{2^ii!}\frac{d^i}{dx^i}(x^2-1)^i$$Similarly to [[Fourier Series]], we aim to express any function as a sum of other functions with certain coefficients, in our case $b_i$. Finding a formula for these coefficients leads to the following observations:

It is easy to find components of a vector when the basis is orthogonal. Take this as an example:![[easy vector components]]
The eigenvectors of a self-adjoint matrix are orthogonal. Letting $V$ be a vector space on which we define the [[Inner product spaces|Inner product]] $(f,g)$ for $f,g\in V$. A linear map on $V$, $\mathcal{L}$ is called self adjoint if:$$\Huge (\mathcal{L}f,g)=(f,\mathcal{L}g)$$For all $f,g\in V$. Let $v_1,v_2$ be two eigenfunctions of $\mathcal{L}$ such that $\mathcal{L}v_1=\lambda_1v_1$ and $\mathcal{L}v_2=\lambda_2v_2$ assuming $\lambda_1\neq \lambda_2$:$$\large (v_1,\mathcal{L}v_2)=(\mathcal{L}v_1,v_2)\implies(v_1,\lambda_2v_2)=(\lambda_1v_2,v_2)\implies \lambda_2(v_1,v_2)=\lambda_1(v_1,v_2)$$$$\Huge \implies(\lambda_2-\lambda_1)(v_1,v_2)=0\implies(v_1,v_2)=0$$Therefore any two eigenfunctions (eigenvectors) of a self-adjoint matrix are orthogonal.

If we can find an inner product such that $\mathcal{L}_L$ is self-adjoint with respect to the inner product, then each $P_i(x)$ are eigenfunctions of $\mathcal{L}_L$ and by the above observations must be orthogonal to each other. We suppose that this inner product is:$$\Huge (f(x),g(x))=\int_{-1}^1f(x)g(x)dx$$The bounds on the integral come from the singular points for Legendre's equation. We can then show the following:$$ (f(x),\mathcal{L}_Lg(x))=\int_{-1}^1f(x)\frac{d}{dx}\left((x^2-1)\frac{dg}{dx}\right)dx=\left[f(x)(x^2-1)\frac{dg}{dx}-\int \frac{df}{dx}(x^2-1)\frac{dg}{dx}dx\right]_{-1}^1$$$$ (f(x),\mathcal{L}_Lg(x))=0-\int_{-1}^1\frac{df}{dx}(x^2-1)\frac{dg}{dx}dx=-\left[\frac{df}{dx}(x^2-1)g(x)-\int \frac{d}{dx}\left((x^2-1)\frac{df}{dx}\right)g(x)\right]_{-1}^1$$$$\Huge (f(x),\mathcal{L}_Lg(x))=0+\int_{-1}^1 \frac{d}{dx}\left((x^2-1)\frac{df}{dx}\right)g(x)=(\mathcal{L}_Lf(x),g(x))$$So we have that $\mathcal{L}_L$ is self-adjoint with respect to this inner product. Then it follows that eigenfunctions $P_i(x)$ are orthogonal with respect to this inner product:$$\Huge (P_i(x),P_j(x))=\int_{-1}^1P_i(x)P_j(x)dx=0$$For all $i\neq j$. Now we can easily calculate coefficients in the Legendre expansion by taking an inner product:$$\large (P_j(x),f(x))=\left(P_j(x),\sum_{i=0}^\infty b_iP_i(x)\right)=\sum_{i=0}^\infty b_i(P_j(x),P_i(x))=b_j(P_j(x),P_j(x))$$This works since the only nonzero term in the sum is where $i=j$. We then solve for $b_j$:$$\Huge b_j=\frac{(P_j(x),f(x))}{(P_j(x),P_j(x))}$$It can be shown that:$$\Huge (P_j(x),P_j(x))=\int_{-1}^1(P_j(x))^2dx=\frac{2}{2j+1}$$We then find an expression for $b_j$:$$\Huge b_j=\frac{2j+1}{2}\int_{-1}^1f(x)P_j(x)dx$$Example:![[legendre expansion example]]
Note that this is similar to a [[Fourier Series]], defined by:$$\large y(x)=\frac{a_0}{2}+\sum_{n=1}^\infty a_n\cos(nx)+\sum_{n=1}^\infty b_n\sin(nx),\,\,b_n=\frac{1}{\pi}\int_{-\pi}^\pi y(x)\sin(nx)dx,...$$
In the Legendre case, the process is as follows:$$\small \mathcal{L}_L=(x^2-1)\frac{d^2}{d^2x}+2x \frac{d}{dx}\rightarrow(f,g)=\int_{-1}^1f(x)g(x)dx\rightarrow f,g,f',g'\text{ finite at }x=\pm1\rightarrow P_n(x)\rightarrow b_i=\frac{(\mathcal{L_L},P_n(x))}{(P_n(x),P_n(x))}$$A differential operator is defined, as well as an inner product, then extra conditions are defined, which leads to finding the Legendre polynomials, eigenfunctions of the differential operator wrt the conditions defined. Coeffieints in an expansion can then be found. The equivalent process for a Fourier series:$$\mathcal{L}_F=\frac{d^2}{dx^2}\rightarrow (f,g)=\int_{-\pi}^\pi f(x)g(x)dx\rightarrow \text{restrict to }2\pi \text{ periodic}\rightarrow \cos(nx),\sin(nx)\rightarrow \text{formulae for }a_0,a_n,b_n$$In the Fourier case, $\cos(nx),\sin(nx)$ satisfy $y''+n^2y=0$, that is $\mathcal{L}_Fy=-n^2y$. We show that $\mathcal{L}_F$ is self adjoint:$$\small (\mathcal{L}_Ff,g)=\int_{-\pi}^\pi \frac{d^2f}{dx^2}g(x)dx=\left[\frac{df}{dx}g(x)\right]_{-\pi}^\pi-\int_{-\pi}^\pi \frac{df}{dx}\frac{dg}{dx}dx=\left[\frac{df}{dx}g(x)-\frac{dg}{dx}f(x)\right]_{-\pi}^\pi+\int_{-\pi}^\pi f(x)\frac{d^2g}{dx^2}dx=(f,\mathcal{L}_Fg)$$This works when restricting functions to those periodic with period $2\pi$. Now $y$ needs to be expanded in terms of eigenfunctions of $\mathcal{L}_F$ with period $2\pi$. Now consider the cases of $\mathcal{L}_Fy=\lambda y$:
>$\lambda=n^2>0\implies y''=n^2y\implies y=Ae^{nx}+Be^{-nx}$, which is not periodic
>$\lambda=0\implies y''=0\implies y=Ax+B$, $A=0$ is periodic, otherwise not periodic
>$\lambda=-n^2<0\implies y''=-n^2y\implies y=A\cos(nx)+B\cos(nx)$, which is $2\pi$ periodic for $n\in \mathbb{Z}$

So we have that $\{\cos(nx),\sin(nx),1\}$ are eigenfunctions of the self adjoint operator $\mathcal{L}_F$, which implies that they are orthogonal functions. Expanding at an arbitrary function, $f(x)$ gives:$$\small (y(x),f(x))=(\frac{a_0}{2}+\sum_{n=1}^\infty a_n\cos(nx)+\sum_{n=1}^\infty b_n\sin(nx),f(x))=\frac{a_0}{2}(1,f(x))+\sum_{n=1}^\infty a_n(\cos(nx),f(x))+\sum_{n=1}^\infty b_n(\sin(nx),f(x))$$
# Approximating functions:

Given $y(x)=\sum_{n=0}^\infty b_nP_n(x)$, consider:$$\Huge S_m=\sum_{n=0}^mb_nP_n(x)$$Here, $S_m$ will be a polynomial of order $m$. We claim that $S_m$ is the best $m$-th order polynomial approximation to $y(x)$. Let $y_m$ be an $m$-th order polynomial and consider the difference squared between $y$ and $y_m$:$$\Huge ||y-y_m||^2=(y-y_m,y-y_m)=\int_{-1}^1(y-y_m)^2dx$$We claim that this is minimised if $y_m=S_m$. Let $g(x)=\sum_{k=0}^\infty a_kP_k(x)$, then:$$ ||g(x)||^2=(g(x),g(x))=\int_{-1}^1g^2(x)dx=\left(\sum_{i=0}^\infty a_iP_i(x),\sum_{j=0}^\infty a_jP_j(x)\right)=\sum_{i,j=0}^\infty a_ia_j(P_i,P_j=\sum_{i=0}^\infty a_i^2(P_i,P_i)$$This works because of the orthogonality of the Legendre polynomials. Using Rodrigue's formula we get:$$\Huge ||g(x)||^2=\sum_{i=0}^\infty a_i^2\frac{2}{2i+1}$$Since $\{P_1,\dots,P_m\}$ form a basis for $\Re[x]_m$, any polynomial $y\in\Re[x]_m$ can be written as:$$\Huge y_m=\sum_{n=0}^mc_nP_n(x)\implies y-y_m=\sum_{n=0}^m(b_n-c_n)P_n(x)+\sum_{n=m+1}^\infty b_nP_n(x)$$Since $y$ can be expressed as the infinite sum. Now we have:$$\Huge ||y-y_m||^2=\sum_{n=0}^m(b_n-c_n)\frac{2}{2n+1}+\sum_{n=m+1}^\infty b_n^2\frac{2}{2n}$$